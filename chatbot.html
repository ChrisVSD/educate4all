<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>educate4all - Î‘Ï€Î»ÏŒÏ‚ AI</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ“</text></svg>">
    <meta name="theme-color" content="#667eea">
    <style>
        /* ÎŸÎ›ÎŸ Î¤ÎŸ CSS ÎœÎ•ÎÎ•Î™ Î™Î”Î™ÎŸ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --glass-bg: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
            --text-white: rgba(255, 255, 255, 0.95);
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--primary-gradient);
            min-height: 100vh;
            color: #333;
            padding: 20px;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: var(--glass-bg);
            backdrop-filter: blur(25px);
            border-radius: 30px;
            border: 1px solid var(--glass-border);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
            overflow: hidden;
        }
        
        /* ... ÎŸÎ›ÎŸ Î¤ÎŸ Î‘Î›Î›ÎŸ CSS ÎœÎ•ÎÎ•Î™ Î™Î”Î™ÎŸ ... */
    </style>
</head>
<body>
    <div class="container">
        <!-- Î— Î™Î”Î™Î‘ Î”ÎŸÎœÎ— ÎœÎ•ÎÎ•Î™ -->
        <div class="header">
            <h1>ğŸ˜Š Î‘Ï€Î»ÏŒÏ‚ AI</h1>
            <p>Î“ÏÎ®Î³Î¿ÏÎµÏ‚ Î±Ï€Î±Î½Ï„Î®ÏƒÎµÎ¹Ï‚, Ï†Î¹Î»Î¹ÎºÏŒ ÏÏ†Î¿Ï‚ ÎºÎ±Î¹ Î±Ï€Î»Î­Ï‚ ÎµÎ¾Î·Î³Î®ÏƒÎµÎ¹Ï‚ Î³Î¹Î± Î²Î±ÏƒÎ¹ÎºÎ­Ï‚ Î­Î½Î½Î¿Î¹ÎµÏ‚</p>
            <div class="ai-badge">âš¡ Î“Î¡Î—Î“ÎŸÎ¡ÎŸ ÎšÎ‘Î™ Î‘Î Î›ÎŸ Î“Î™Î‘ ÎŸÎ›ÎŸÎ¥Î£</div>
        </div>
        
        <div class="glass-navigation">
            <a href="index.html" class="nav-button">ğŸ  Î‘ÏÏ‡Î¹ÎºÎ®</a>
            <a href="courses.html" class="nav-button">ğŸ“š ÎœÎ±Î¸Î®Î¼Î±Ï„Î±</a>
            <a href="real-ai-chatbot.html" class="nav-button">ğŸ¤– Î ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÏŒÏ‚ AI</a>
            <a href="smart-chatbot.html" class="nav-button">ğŸ§  ÎˆÎ¾Ï…Ï€Î½Î¿Ï‚ AI</a>
        </div>

        <div class="teacher-section">
            <div class="teacher-avatar">ğŸ’­</div>
            <div class="teacher-info">
                <div class="teacher-name">Î£Ï‰ÎºÏÎ¬Ï„Î·Ï‚</div>
                <div class="teacher-subject">Î¦Î¹Î»ÏŒÏƒÎ¿Ï†Î¿Ï‚ - Î•Î¹Î´Î¹ÎºÏŒÏ‚ ÏƒÎµ Î±Ï€Î»Î­Ï‚ ÎºÎ±Î¹ Ï†Î¹Î»Î¹ÎºÎ­Ï‚ ÎµÎ¾Î·Î³Î®ÏƒÎµÎ¹Ï‚</div>
            </div>
        </div>
        
        <div class="api-section">
            <p><strong>ğŸ”‘ Î’Î®Î¼Î± 1:</strong> Î’Î¬Î»Îµ Ï„Î¿ Groq API Key ÏƒÎ¿Ï… (Î´Ï‰ÏÎµÎ¬Î½)</p>
            <div class="api-input-group">
                <input type="password" id="apiKeyInput" class="api-input" placeholder="gsk_xxxxxxxxxxxxxxxx">
                <button onclick="saveAPIKey()" class="save-api-btn">ğŸ’¾ Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·</button>
            </div>
            <div id="apiStatus"></div>
        </div>
        
        <div class="quick-questions">
            <p><strong>ğŸš€ Î“ÏÎ®Î³Î¿ÏÎµÏ‚ Î•ÏÏ‰Ï„Î®ÏƒÎµÎ¹Ï‚:</strong></p>
            <div class="quick-buttons">
                <button class="quick-btn" onclick="askQuickQuestion('Î ÏÏ‚ Î»ÏÎ½Ï‰ ÎµÎ¾Î¹ÏƒÏÏƒÎµÎ¹Ï‚ Î²Î„ Î²Î±Î¸Î¼Î¿Ï;')">ğŸ“ Î•Î¾Î¹ÏƒÏÏƒÎµÎ¹Ï‚ Î²Î„ Î²Î±Î¸Î¼Î¿Ï</button>
                <button class="quick-btn" onclick="askQuickQuestion('Î¤Î¹ ÎµÎ¯Î½Î±Î¹ Î· Ï†Ï‰Ï„Î¿ÏƒÏÎ½Î¸ÎµÏƒÎ·;')">ğŸŒ¿ Î¦Ï‰Ï„Î¿ÏƒÏÎ½Î¸ÎµÏƒÎ·</button>
                <button class="quick-btn" onclick="askQuickQuestion('Î•Î¾Î®Î³Î·ÏƒÎµ Ï„Î¿ Î Ï…Î¸Î±Î³ÏŒÏÎµÎ¹Î¿ Î¸ÎµÏÏÎ·Î¼Î±')">ğŸ“ Î Ï…Î¸Î±Î³ÏŒÏÎµÎ¹Î¿ Î¸ÎµÏÏÎ·Î¼Î±</button>
                <button class="quick-btn" onclick="askQuickQuestion('Î Î¿Î¹Î¿Ï‚ Î®Ï„Î±Î½ Î¿ Î£Ï‰ÎºÏÎ¬Ï„Î·Ï‚;')">ğŸ›ï¸ Î£Ï‰ÎºÏÎ¬Ï„Î·Ï‚</button>
                <button class="quick-btn" onclick="askQuickQuestion('Î¤Î¹ ÎµÎ¯Î½Î±Î¹ Ï„Î¿ DNA;')">ğŸ§¬ DNA</button>
                <button class="quick-btn" onclick="askQuickQuestion('Î ÏÏ‚ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯ Î¿ Î·Î»Î¹Î±ÎºÏŒÏ‚ ÏƒÏ…Î»Î»Î­ÎºÏ„Î·Ï‚;')">â˜€ï¸ Î—Î»Î¹Î±ÎºÏŒÏ‚ Î£Ï…Î»Î»Î­ÎºÏ„Î·Ï‚</button>
            </div>
        </div>
        
        <div class="chat-container" id="chat">
            <div class="message bot-message">
                <strong>ğŸ‘‹ Î“ÎµÎ¹Î± ÏƒÎ¿Ï…! Î•Î¯Î¼Î±Î¹ Î¿ Î‘Ï€Î»ÏŒÏ‚ AI Î’Î¿Î·Î¸ÏŒÏ‚! ğŸ˜Š</strong><br><br>
                ğŸ¯ <strong>Î•Î¯Î¼Î±Î¹ ÎµÎ´Ï Î³Î¹Î± Î±Ï€Î»Î­Ï‚ ÎºÎ±Î¹ Ï†Î¹Î»Î¹ÎºÎ­Ï‚ ÏƒÏ…Î¶Î·Ï„Î®ÏƒÎµÎ¹Ï‚!</strong><br><br>
                ğŸ’¡ <strong>ÎœÏ€Î¿ÏÏ Î½Î± Î²Î¿Î·Î¸Î®ÏƒÏ‰ Î¼Îµ:</strong><br>
                â€¢ ğŸ“ <strong>Î£ÏÎ½Ï„Î¿Î¼ÎµÏ‚ ÎµÎ¾Î·Î³Î®ÏƒÎµÎ¹Ï‚</strong> Î³Î¹Î± Î²Î±ÏƒÎ¹ÎºÎ­Ï‚ Î­Î½Î½Î¿Î¹ÎµÏ‚<br>
                â€¢ ğŸ¯ <strong>Î“ÏÎ®Î³Î¿ÏÎµÏ‚ Î±Ï€Î±Î½Ï„Î®ÏƒÎµÎ¹Ï‚</strong> ÏƒÎµ Î±Ï€Î»Î­Ï‚ ÎµÏÏ‰Ï„Î®ÏƒÎµÎ¹Ï‚<br>
                â€¢ ğŸ“š <strong>Î’Î±ÏƒÎ¹ÎºÎ­Ï‚ Î­Î½Î½Î¿Î¹ÎµÏ‚</strong> Î¼Îµ Î±Ï€Î»Î® Î³Î»ÏÏƒÏƒÎ±<br>
                â€¢ ğŸƒ <strong>Î‘Ï€Î»Î­Ï‚ Î»ÏÏƒÎµÎ¹Ï‚</strong> Î³Î¹Î± ÎºÎ±Î¸Î·Î¼ÎµÏÎ¹Î½Î¬ Ï€ÏÎ¿Î²Î»Î®Î¼Î±Ï„Î±<br>
                â€¢ ğŸ’¬ <strong>Î¦Î¹Î»Î¹ÎºÎ­Ï‚ ÏƒÏ…Î¶Î·Ï„Î®ÏƒÎµÎ¹Ï‚</strong> Î³Î¹Î± ÏŒÎ»Î± Ï„Î± Î¸Î­Î¼Î±Ï„Î±<br><br>
                âœ¨ <strong>Î¡ÏÏ„Î± Î¼Îµ Î¿Ï„Î¹Î´Î®Ï€Î¿Ï„Îµ Î¸Î­Î»ÎµÎ¹Ï‚ Î½Î± Î¼Î¬Î¸ÎµÎ¹Ï‚ - Î¸Î± Î±Ï€Î±Î½Ï„Î®ÏƒÏ‰ Î±Ï€Î»Î¬ ÎºÎ±Î¹ Î³ÏÎ®Î³Î¿ÏÎ±!</strong>
                <div class="message-time">Î¤ÏÏÎ±</div>
            </div>
        </div>
        
        <div class="input-container">
            <input type="text" id="userInput" placeholder="Î¡ÏÏ„Î± Î¼Îµ Î¿Ï„Î¹Î´Î®Ï€Î¿Ï„Îµ Î³Î¹Î± Ï„Î± Î¼Î±Î¸Î®Î¼Î±Ï„Î±..." onkeypress="handleKeyPress(event)">
            <button onclick="sendMessage()">ğŸ“¨ Î‘Ï€Î¿ÏƒÏ„Î¿Î»Î®</button>
        </div>
    </div>

    <script>
        // ğŸ”§ ENHANCED GROQ API CONFIG
        let apiKey = localStorage.getItem('educate4all_simple_api_key') || "";
        let conversationHistory = [];
        
        // ENHANCED FILTERS - Î‘Î¥Î£Î¤Î—Î¡ÎŸ Î¦Î™Î›Î¤Î¡Î‘Î¡Î™Î£ÎœÎ‘
        const inappropriateKeywords = [
            'Î¼Î±Î»Î¬ÎºÎ±Ï‚', 'Î±ÏÏ‡Î¯Î´Î¹', 'ÏƒÎºÎ±Ï„Î¬', 'Î³Î±Î¼Ï', 'Ï€Î¿Ï…Ï„Î¬Î½Î±', 'Ï€Î¿Ï…ÏƒÏ„', 'Î¼Î±Î»Î±Îº', 'Î±ÏÏ‡Î¹Î´', 'Î³Î±Î¼Ï‰',
            'fuck', 'shit', 'asshole', 'bitch', 'dick', 'pussy', 'bastard', 'cunt'
        ];
        
        const offTopicKeywords = [
            // Î‘Î˜Î›Î—Î¤Î™ÎšÎ‘
            'Ï€Î¿Î´ÏŒÏƒÏ†Î±Î¹ÏÎ¿', 'Î¼Ï€Î¬Î»Î±', 'Î³ÎºÎ¿Î»', 'ÏƒÎºÎ¿Ï', 'Î±Î³ÏÎ½Î±Ï‚', 'Ï€Î±Î¹Ï‡Î½Î¯Î´Î¹', 'Î¿Î¼Î¬Î´Î±', 'Î±ÎµÎº', 'Î¿Î»Ï…Î¼Ï€Î¹Î±ÎºÏŒÏ‚', 'Ï€Î±Î½Î±Î¸Î·Î½Î±ÏŠÎºÏŒÏ‚', 'Ï€Î±Î¿Îº',
            'Ï‡ÏŒÎºÎµÏŠ', 'Î¼Ï€Î¬ÏƒÎºÎµÏ„', 'Î²ÏŒÎ»ÎµÏŠ', 'Ï„Î­Î½Î½Î¹Ï‚', 'Î¼Î¬ÏÏ‚', 'Î½Î¯ÎºÎ·', 'Î®Ï„Ï„Î±', 'Ï€ÏÏ‰Ï„Î¬Î¸Î»Î·Î¼Î±', 'ÎºÏÏ€ÎµÎ»Î»Î¿',
            'football', 'soccer', 'basketball', 'volleyball', 'tennis', 'match', 'score', 'team', 'player',
            
            // SOCIAL MEDIA
            'instagram', 'tiktok', 'facebook', 'twitter', 'social media', 'reels', 'story', 'like', 'follower',
            
            // Î¨Î¥Î§Î‘Î“Î©Î“Î™Î‘
            'Î²Î¯Î½Ï„ÎµÎ¿', 'Ï„ÏÎ±Î³Î¿ÏÎ´Î¹', 'Ï„Î±Î¹Î½Î¯Î±', 'ÏƒÎµÎ¯ÏÎ¹Î±Î»', 'netflix', 'youtube', 'spotify', 'ÎºÎ¹Î½Î·Î¼Î±Ï„Î¿Î³ÏÎ¬Ï†Î¿Ï‚', 'Î¼Î¿Ï…ÏƒÎ¹ÎºÎ®',
            'video', 'song', 'movie', 'series', 'cinema', 'music',
            
            // Î‘Î“ÎŸÎ¡Î•Î£
            'ÏˆÏÎ½Î¹Î±', 'Î±Î³Î¿ÏÎ­Ï‚', 'ÏÎ¿ÏÏ‡Î±', 'Î±Î¸Î»Î·Ï„Î¹ÎºÎ¬', 'shopping', 'mall', 'ÎºÎ±Ï„Î¬ÏƒÏ„Î·Î¼Î±', 'Î­ÎºÏ€Ï„Ï‰ÏƒÎ·',
            
            // Î ÎŸÎ›Î™Î¤Î™ÎšÎ—
            'Ï€Î¿Î»Î¹Ï„Î¹ÎºÎ®', 'ÎºÏŒÎ¼Î¼Î±', 'Î²Î¿Ï…Î»Î®', 'ÎµÎºÎ»Î¿Î³Î­Ï‚', 'Ï€Î¿Î»Î¹Ï„Î¹ÎºÏŒÏ‚', 'ÎºÏ…Î²Î­ÏÎ½Î·ÏƒÎ·', 'Î±Î½Ï„Î¹Ï€Î¿Î»Î¯Ï„ÎµÏ…ÏƒÎ·',
            'politics', 'government', 'election', 'vote',
            
            // Î‘Î£Î§Î•Î¤Î‘ Î˜Î•ÎœÎ‘Î¤Î‘
            'game', 'games', 'Ï€Î±Î¹Ï‡Î½Î¯Î´Î¹', 'gaming', 'streaming', 'twitch'
        ];

        const educationalKeywords = [
            // ÎœÎ‘Î˜Î—ÎœÎ‘Î¤Î™ÎšÎ‘
            'Î¼Î±Î¸Î·Î¼Î±Ï„Î¹ÎºÎ¬', 'Î¼Î±Î¸Î·Î¼Î±Ï„Î¹Îº', 'Î¬Î»Î³ÎµÎ²ÏÎ±', 'Î³ÎµÏ‰Î¼ÎµÏ„ÏÎ¯Î±', 'Ï„ÏÎ¹Î³Ï‰Î½Î¿Î¼ÎµÏ„ÏÎ¯Î±', 'Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚', 'ÎµÎ¾Î¯ÏƒÏ‰ÏƒÎ·', 'Ï€ÏÎ¬Î¾Î·', 'Î±ÏÎ¹Î¸Î¼ÏŒÏ‚',
            'math', 'algebra', 'geometry', 'calculus', 'equation', 'number',
            
            // Î¦Î¥Î£Î™ÎšÎ—
            'Ï†Ï…ÏƒÎ¹ÎºÎ®', 'Ï†Ï…ÏƒÎ¹Îº', 'Î¼Î·Ï‡Î±Î½Î¹ÎºÎ®', 'Î·Î»ÎµÎºÏ„ÏÎ¿Î¼Î±Î³Î½Î·Ï„Î¹ÏƒÎ¼ÏŒÏ‚', 'Î¸ÎµÏÎ¼Î¿Î´Ï…Î½Î±Î¼Î¹ÎºÎ®', 'Î´ÏÎ½Î±Î¼Î·', 'ÎµÏ€Î¹Ï„Î¬Ï‡Ï…Î½ÏƒÎ·', 'ÎµÎ½Î­ÏÎ³ÎµÎ¹Î±',
            'physics', 'mechanics', 'energy', 'force', 'acceleration',
            
            // Î§Î—ÎœÎ•Î™Î‘
            'Ï‡Î·Î¼ÎµÎ¯Î±', 'Ï‡Î·Î¼Î¹Îº', 'ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î¿', 'Î±Î½Ï„Î¯Î´ÏÎ±ÏƒÎ·', 'Î¼ÏŒÏÎ¹Î¿', 'Î¬Ï„Î¿Î¼Î¿', 'Ï€ÎµÏÎ¹Î¿Î´Î¹ÎºÏŒÏ‚', 'Ï€Ï…ÏÎ·Î½Î¹ÎºÎ®',
            'chemistry', 'element', 'reaction', 'molecule', 'atom',
            
            // Î’Î™ÎŸÎ›ÎŸÎ“Î™Î‘
            'Î²Î¹Î¿Î»Î¿Î³Î¯Î±', 'Î²Î¹Î¿Î»Î¿Î³', 'ÎºÏÏ„Ï„Î±ÏÎ¿', 'dna', 'Î³Î¿Î½Î¯Î´Î¹Î¿', 'ÎµÎ¾Î­Î»Î¹Î¾Î·', 'Î±Î½Î±Ï€Î½Î¿Î®', 'Ï†Ï‰Ï„Î¿ÏƒÏÎ½Î¸ÎµÏƒÎ·',
            'biology', 'cell', 'gene', 'evolution', 'respiration',
            
            // Î•ÎšÎ Î‘Î™Î”Î•Î¥Î£Î—
            'Î¼Î¬Î¸Î·Î¼Î±', 'ÎµÎºÏ€Î±Î¯Î´ÎµÏ…ÏƒÎ·', 'ÏƒÏ‡Î¿Î»ÎµÎ¯Î¿', 'Î´Î¹Î´Î±ÏƒÎºÎ±Î»Î¯Î±', 'ÎµÎºÎ¼Î¬Î¸Î·ÏƒÎ·', 'Î³Î½ÏÏƒÎ·', 'ÎµÎ¾Î­Ï„Î±ÏƒÎ·', 'Î´Î¹Î±Î³ÏÎ½Î¹ÏƒÎ¼Î±',
            'lesson', 'education', 'school', 'teaching', 'learning', 'knowledge',
            
            // Î“Î›Î©Î£Î£Î‘
            'Î³ÏÎ±Î¼Î¼Î±Ï„Î¹ÎºÎ®', 'Î¿ÏÎ¸Î¿Î³ÏÎ±Ï†Î¯Î±', 'ÏƒÏÎ½Ï„Î±Î¾Î·', 'Î»Î­Î¾Î·', 'Ï€ÏÏŒÏ„Î±ÏƒÎ·', 'ÏÎ·Î¼Î±', 'Î¿Ï…ÏƒÎ¹Î±ÏƒÏ„Î¹ÎºÏŒ',
            'grammar', 'spelling', 'syntax', 'word', 'sentence'
        ];
        
        // Initialize on load
        document.addEventListener('DOMContentLoaded', function() {
            updateAPIStatus();
            loadLastSubject();
            loadConversationHistory();
            setupCleanupSystem();
            
            const welcomeMessage = document.querySelector('.bot-message');
            if (welcomeMessage) {
                welcomeMessage.style.animation = 'fadeInUp 0.8s ease-out';
            }
        });
        
        function updateAPIStatus() {
            const apiStatus = document.getElementById('apiStatus');
            const apiKeyInput = document.getElementById('apiKeyInput');
            
            if (apiKey && apiKey.startsWith('gsk_')) {
                apiStatus.innerHTML = '<div class="success-message">âœ… Groq API Key ÎµÎ¯Î½Î±Î¹ Î­Ï„Î¿Î¹Î¼Î¿ Î³Î¹Î± Î±Ï€Î»Î­Ï‚ ÏƒÏ…Î¶Î·Ï„Î®ÏƒÎµÎ¹Ï‚!</div>';
                apiKeyInput.placeholder = 'âœ… API Key ÎµÎ¯Î½Î±Î¹ Î±Ï€Î¿Î¸Î·ÎºÎµÏ…Î¼Î­Î½Î¿';
                apiKeyInput.value = '';
            } else {
                apiStatus.innerHTML = '<div class="error-message">âŒ Î§ÏÎµÎ¹Î¬Î¶ÎµÏƒÎ±Î¹ Groq API Key Î³Î¹Î± Ï„Î¿Î½ Î‘Ï€Î»ÏŒ AI</div>';
                apiKeyInput.placeholder = 'gsk_xxxxxxxxxxxxxxxx';
            }
        }
        
        function saveAPIKey() {
            const apiKeyInput = document.getElementById('apiKeyInput');
            const inputKey = apiKeyInput.value.trim();
            
            if (inputKey && inputKey.startsWith('gsk_')) {
                apiKey = inputKey;
                localStorage.setItem('educate4all_simple_api_key', apiKey);
                updateAPIStatus();
                
                apiKeyInput.style.animation = 'shake 0.5s ease-in-out';
                setTimeout(() => {
                    apiKeyInput.style.animation = '';
                }, 500);
                
                showTemporaryMessage('âœ… API Key Î±Ï€Î¿Î¸Î·ÎºÎµÏÏ„Î·ÎºÎµ ÎµÏ€Î¹Ï„Ï…Ï‡ÏÏ‚!', 'success');
            } else if (inputKey) {
                showTemporaryMessage('âŒ Î›Î¬Î¸Î¿Ï‚ API Key. Î ÏÎ­Ï€ÎµÎ¹ Î½Î± Î¾ÎµÎºÎ¹Î½Î¬ÎµÎ¹ Î¼Îµ "gsk_"', 'error');
            }
        }
        
        function handleKeyPress(event) {
            if (event.key === 'Enter') sendMessage();
        }
        
        function askQuickQuestion(question) {
            document.getElementById('userInput').value = question;
            sendMessage();
        }
        
        function loadLastSubject() {
            const lastSubject = sessionStorage.getItem('last_course_subject');
            if (lastSubject) {
                const userInput = document.getElementById('userInput');
                userInput.placeholder = `Î¡ÏÏ„Î± Î³Î¹Î± ${lastSubject}...`;
                
                const chat = document.getElementById('chat');
                const subjectMessage = document.createElement('div');
                subjectMessage.className = 'message bot-message';
                subjectMessage.innerHTML = `
                    <strong>ğŸ“š Î£Ï…Î½ÎµÏ‡Î¯Î¶Î¿Ï…Î¼Îµ Î¼Îµ ${lastSubject}!</strong><br>
                    Î¡ÏÏ„Î± Î¼Îµ Î¿Ï„Î¹Î´Î®Ï€Î¿Ï„Îµ Î¸Î­Î»ÎµÎ¹Ï‚ Î³Î¹Î± Î±Ï…Ï„ÏŒ Ï„Î¿ Î¼Î¬Î¸Î·Î¼Î± - Î¸Î± Î±Ï€Î±Î½Ï„Î®ÏƒÏ‰ Î±Ï€Î»Î¬ ÎºÎ±Î¹ Î³ÏÎ®Î³Î¿ÏÎ±!
                    <div class="message-time">Î¤ÏÏÎ±</div>`;
                chat.appendChild(subMessage);
                chat.scrollTop = chat.scrollHeight;
            }
        }
        
        function loadConversationHistory() {
            // Load only from sessionStorage - auto-cleared on browser close
            const conversations = JSON.parse(sessionStorage.getItem('educate4all_conversations') || '[]');
            const recentConversations = conversations.filter(conv => conv.aiType === 'simple').slice(-8);
            
            const chat = document.getElementById('chat');
            recentConversations.forEach(conv => {
                const userMessage = document.createElement('div');
                userMessage.className = 'message user-message';
                userMessage.textContent = conv.question;
                chat.appendChild(userMessage);
                
                const botMessage = document.createElement('div');
                botMessage.className = 'message bot-message';
                botMessage.innerHTML = formatAIResponse(conv.answer) + 
                    `<div class="message-time">${new Date(conv.timestamp).toLocaleTimeString('el-GR')}</div>`;
                chat.appendChild(botMessage);
                
                // Add to conversation history for context
                conversationHistory.push(
                    { role: "user", content: conv.question },
                    { role: "assistant", content: conv.answer }
                );
            });
            
            if (recentConversations.length > 0) {
                chat.scrollTop = chat.scrollHeight;
            }
        }
        
        // ENHANCED QUESTION VALIDATION - Î‘Î¥Î£Î¤Î—Î¡ÎŸÎ¤Î•Î¡ÎŸ Î•Î›Î•Î“Î§ÎŸ
        function checkQuestionValidity(question) {
            const lowerQuestion = question.toLowerCase().trim();
            
            // Check for inappropriate language
            for (const keyword of inappropriateKeywords) {
                if (lowerQuestion.includes(keyword)) {
                    return {
                        valid: false,
                        type: 'inappropriate',
                        message: 'ğŸ™ Î— Ï€Î»Î±Ï„Ï†ÏŒÏÎ¼Î± Î¼Î±Ï‚ Ï€ÏÎ¿Ï‰Î¸ÎµÎ¯ ÏƒÎµÎ²Î±ÏƒÎ¼ÏŒ ÎºÎ±Î¹ Ï†Î¹Î»Î¹ÎºÎ® ÏƒÏ…Î¼Ï€ÎµÏÎ¹Ï†Î¿ÏÎ¬.<br><br>âœ¨ Î‘Ï‚ ÎµÏ€Î¹ÏƒÏ„ÏÎ­ÏˆÎ¿Ï…Î¼Îµ ÏƒÏ„Î¹Ï‚ Ï†Î¹Î»Î¹ÎºÎ­Ï‚ ÏƒÏ…Î¶Î·Ï„Î®ÏƒÎµÎ¹Ï‚! ğŸ˜Š'
                    };
                }
            }
            
            // Check for off-topic content - Î‘Î¥Î£Î¤Î—Î¡ÎŸÎ¤Î•Î¡ÎŸÎ£ Î•Î›Î•Î“Î§ÎŸÎ£
            let hasOffTopic = false;
            let hasEducational = false;
            
            for (const keyword of offTopicKeywords) {
                if (lowerQuestion.includes(keyword)) {
                    hasOffTopic = true;
                    break;
                }
            }
            
            for (const keyword of educationalKeywords) {
                if (lowerQuestion.includes(keyword)) {
                    hasEducational = true;
                    break;
                }
            }
            
            // Î‘Î½ Î­Ï‡ÎµÎ¹ off-topic keyword ÎºÎ±Î¹ Î”Î•Î Î­Ï‡ÎµÎ¹ educational keyword, Î±Ï€Î¿ÏÏÎ¯Ï€Ï„ÎµÏ„Î±Î¹
            if (hasOffTopic && !hasEducational) {
                return {
                    valid: false,
                    type: 'offtopic',
                    message: `ğŸ¯ Î‘Ï‚ ÎµÏ€Î¹ÎºÎµÎ½Ï„ÏÏ‰Î¸Î¿ÏÎ¼Îµ ÏƒÏ„Î¿ ÎµÎºÏ€Î±Î¹Î´ÎµÏ…Ï„Î¹ÎºÏŒ Ï€ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿!<br><br>ğŸ“š ÎœÏ€Î¿ÏÏ Î½Î± Î²Î¿Î·Î¸Î®ÏƒÏ‰ Î¼Îµ:<br>â€¢ ÎœÎ±Î¸Î·Î¼Î±Ï„Î¹ÎºÎ¬ & Î•Ï€Î¹ÏƒÏ„Î®Î¼ÎµÏ‚<br>â€¢ Î™ÏƒÏ„Î¿ÏÎ¯Î± & Î“Î»ÏÏƒÏƒÎ±<br>â€¢ Î’Î±ÏƒÎ¹ÎºÎ­Ï‚ Î­Î½Î½Î¿Î¹ÎµÏ‚ & Î•Î¾Î·Î³Î®ÏƒÎµÎ¹Ï‚<br><br>ğŸ’¡ Î¡ÏÏ„Î± Î¼Îµ ÎºÎ¬Ï„Î¹ ÏƒÏ‡ÎµÏ„Î¹ÎºÏŒ Î¼Îµ Ï„Î· Î¼Î¬Î¸Î·ÏƒÎ·! ğŸ˜Š`
                };
            }
            
            return { valid: true };
        }
        
        async function sendMessage() {
            if (!apiKey || !apiKey.startsWith('gsk_')) {
                showError('âŒ Î§ÏÎµÎ¹Î¬Î¶ÎµÏƒÎ±Î¹ Groq API Key. Î’Î¬Î»Îµ Ï„Î¿ Ï€Î±ÏÎ±Ï€Î¬Î½Ï‰.');
                return;
            }
            
            const userInput = document.getElementById('userInput');
            const chat = document.getElementById('chat');
            const message = userInput.value.trim();
            
            if (message === '') return;
            
            // Enhanced question validation
            const validation = checkQuestionValidity(message);
            if (!validation.valid) {
                const userMessage = document.createElement('div');
                userMessage.className = 'message user-message';
                userMessage.innerHTML = `${message}<div class="message-time">${new Date().toLocaleTimeString('el-GR')}</div>`;
                chat.appendChild(userMessage);
                userInput.value = '';
                
                const redirectMessage = document.createElement('div');
                redirectMessage.className = 'message bot-message';
                redirectMessage.innerHTML = validation.message + 
                    `<div class="message-time">${new Date().toLocaleTimeString('el-GR')}</div>`;
                chat.appendChild(redirectMessage);
                
                chat.scrollTop = chat.scrollHeight;
                return;
            }
            
            // Add user message
            const userMessage = document.createElement('div');
            userMessage.className = 'message user-message';
            userMessage.innerHTML = `${message}<div class="message-time">${new Date().toLocaleTimeString('el-GR')}</div>`;
            chat.appendChild(userMessage);
            userInput.value = '';
            
            // Add typing indicator
            const typingIndicator = document.createElement('div');
            typingIndicator.className = 'message bot-message';
            typingIndicator.innerHTML = '<div class="typing-indicator">ğŸ’­ <strong>Î‘Ï€Î»ÏŒÏ‚ AI</strong> ÏƒÎºÎ­Ï†Ï„ÎµÏ„Î±Î¹<span class="typing-dots"><span>.</span><span>.</span><span>.</span></span></div>';
            chat.appendChild(typingIndicator);
            chat.scrollTop = chat.scrollHeight;
            
            try {
                const botResponse = await getAIResponse(message);
                chat.removeChild(typingIndicator);
                
                const botMessage = document.createElement('div');
                botMessage.className = 'message bot-message';
                botMessage.innerHTML = formatAIResponse(botResponse) + 
                    `<div class="message-time">${new Date().toLocaleTimeString('el-GR')}</div>`;
                chat.appendChild(botMessage);
                
                // Save conversation to sessionStorage only
                saveConversation(message, botResponse);
                
                // Add to conversation history for context
                conversationHistory.push(
                    { role: "user", content: message },
                    { role: "assistant", content: botResponse }
                );
                
                // Keep conversation history manageable
                if (conversationHistory.length > 20) {
                    conversationHistory = conversationHistory.slice(-20);
                }
                
            } catch (error) {
                chat.removeChild(typingIndicator);
                showError('âŒ Î£Ï†Î¬Î»Î¼Î±: ' + error.message);
                console.error('API Error:', error);
            }
            
            chat.scrollTop = chat.scrollHeight;
        }
        
        async function getAIResponse(userMessage) {
            // Prepare messages with conversation history for context
            const messages = [
                {
                    role: "system",
                    content: `Î•Î¯ÏƒÎ±Î¹ Î¿ Î‘Î Î›ÎŸÎ£ AI Î²Î¿Î·Î¸ÏŒÏ‚ Ï„Î¿Ï… educate4all - Ï†Î¹Î»Î¹ÎºÏŒÏ‚ ÎºÎ±Î¹ Ï€ÏÎ¿ÏƒÎ¹Ï„ÏŒÏ‚ Î³Î¹Î± Î²Î±ÏƒÎ¹ÎºÎ­Ï‚ ÎµÏÏ‰Ï„Î®ÏƒÎµÎ¹Ï‚.

Î•Î™Î”Î™ÎšÎŸÎ¤Î—Î¤Î‘: Î‘Ï€Î»Î­Ï‚ ÎºÎ±Î¹ Î³ÏÎ®Î³Î¿ÏÎµÏ‚ ÎµÎ¾Î·Î³Î®ÏƒÎµÎ¹Ï‚ Î³Î¹Î± ÎºÎ±Î¸Î·Î¼ÎµÏÎ¹Î½Î­Ï‚ ÎµÏÏ‰Ï„Î®ÏƒÎµÎ¹Ï‚

Î£Î¤Î¥Î› Î‘Î Î‘ÎÎ¤Î—Î£Î•Î©Î:
- Î Î¿Î»Ï Î±Ï€Î»Î­Ï‚ ÎºÎ±Î¹ ÏƒÏÎ½Ï„Î¿Î¼ÎµÏ‚ ÎµÎ¾Î·Î³Î®ÏƒÎµÎ¹Ï‚
- Î•Î¾Î±Î¹ÏÎµÏ„Î¹ÎºÎ¬ Ï†Î¹Î»Î¹ÎºÏŒ ÎºÎ±Î¹ Ï€ÏÎ¿ÏƒÎ¹Ï„ÏŒ ÏÏ†Î¿Ï‚
- Î§ÏÎ®ÏƒÎ· Ï€Î¿Î»Ï Î±Ï€Î»ÏÎ½ Ï€Î±ÏÎ±Î´ÎµÎ¹Î³Î¼Î¬Ï„Ï‰Î½
- Î•ÏƒÏ„Î¯Î±ÏƒÎ· ÏƒÏ„Î¹Ï‚ Î²Î±ÏƒÎ¹ÎºÏŒÏ„ÎµÏÎµÏ‚ Î­Î½Î½Î¿Î¹ÎµÏ‚
- Î£Î±Ï†ÎµÎ¯Ï‚ ÎºÎ±Î¹ ÎºÎ±Ï„Î±Î½Î¿Î·Ï„Î­Ï‚ Î±Ï€Î±Î½Ï„Î®ÏƒÎµÎ¹Ï‚
- Î§ÏÎ®ÏƒÎ· emojis Î³Î¹Î± Î¶Ï‰Î½Ï„Î¬Î½Î¹Î± ÎºÎ±Î¹ Ï†Î¹Î»Î¹ÎºÏŒÏ„Î·Ï„Î±

ÎšÎ‘ÎÎŸÎÎ•Î£:
- Î‘Ï€Î¬Î½Ï„Î± Î Î‘ÎÎ¤Î‘ ÏƒÏ„Î± Î•Î›Î›Î—ÎÎ™ÎšÎ‘
- ÎšÏÎ¬Ï„Î± Ï„Î¹Ï‚ Î±Ï€Î±Î½Ï„Î®ÏƒÎµÎ¹Ï‚ Î ÎŸÎ›Î¥ ÏƒÏÎ½Ï„Î¿Î¼ÎµÏ‚ (1-2 Ï€Î±ÏÎ±Î³ÏÎ¬Ï†Î¿Ï…Ï‚)
- Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¯Î·ÏƒÎµ Î ÎŸÎ›Î¥ Î±Ï€Î»Î¬ Ï€Î±ÏÎ±Î´ÎµÎ¯Î³Î¼Î±Ï„Î± Ï€Î¿Ï… ÏŒÎ»Î¿Î¹ ÎºÎ±Ï„Î±Î»Î±Î²Î±Î¯Î½Î¿Ï…Î½
- ÎˆÏ‡Îµ Î ÎŸÎ›Î¥ Ï†Î¹Î»Î¹ÎºÏŒ ÎºÎ±Î¹ ÎµÎ½Î¸Î±ÏÏÏ…Î½Ï„Î¹ÎºÏŒ ÏÏ†Î¿Ï‚
- Î‘Î½ ÎºÎ¬Ï„Î¹ ÎµÎ¯Î½Î±Î¹ Ï€Î¿Î»ÏÏ€Î»Î¿ÎºÎ¿, Î±Ï€Î»Î¿Ï€Î¿Î¯Î·ÏƒÎ­ Ï„Î¿ Î£Î—ÎœÎ‘ÎÎ¤Î™ÎšÎ‘
- Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¯Î·ÏƒÎµ emojis Î³Î¹Î± Î½Î± ÎºÎ¬Î½ÎµÎ¹Ï‚ Ï„Î·Î½ Î±Ï€Î¬Î½Ï„Î·ÏƒÎ· Ï€Î¹Î¿ Ï†Î¹Î»Î¹ÎºÎ®
- Î‘Î½ Î´ÎµÎ½ Î³Î½Ï‰ÏÎ¯Î¶ÎµÎ¹Ï‚, Ï€ÎµÏ‚ Ï„Î¿ ÎµÎ¹Î»Î¹ÎºÏÎ¹Î½Î¬ ÎºÎ±Î¹ Î±Ï€Î»Î¬
- ÎœÎ™Î‘ Î“Î™Î‘ Î Î‘ÎÎ¤Î‘: Î‘Î Î›Î‘ ÎšÎ‘Î™ Î“Î¡Î—Î“ÎŸÎ¡Î‘!

Î•Î™Î”Î™ÎšÎ•Î£ ÎŸÎ”Î—Î“Î™Î•Î£:
- ÎœÎ—Î ÎºÎ¬Î½ÎµÎ¹Ï‚ Î¼Î±ÎºÏÎ¹Î­Ï‚ Î±Î½Î±Î»ÏÏƒÎµÎ¹Ï‚
- ÎœÎ—Î Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï‚ Ï€Î¿Î»Î»Î¿ÏÏ‚ Ï„ÎµÏ‡Î½Î¹ÎºÎ¿ÏÏ‚ ÏŒÏÎ¿Ï…Ï‚
- ÎœÎ—Î Î´Î¯Î½ÎµÎ¹Ï‚ Ï€Î¿Î»Î»Î­Ï‚ Î»ÎµÏ€Ï„Î¿Î¼Î­ÏÎµÎ¹ÎµÏ‚
- ÎÎ‘Î™: Î‘Ï€Î»Î­Ï‚ ÎµÎ¾Î·Î³Î®ÏƒÎµÎ¹Ï‚, Ï†Î¹Î»Î¹ÎºÏŒ ÏÏ†Î¿Ï‚, Î³ÏÎ®Î³Î¿ÏÎµÏ‚ Î±Ï€Î±Î½Ï„Î®ÏƒÎµÎ¹Ï‚

Î˜Ï…Î¼Î®ÏƒÎ¿Ï…: Î•Î¯ÏƒÎ±Î¹ Î¿ Ï†Î¹Î»Î¹ÎºÏŒÏ‚ Î²Î¿Î·Î¸ÏŒÏ‚ Î³Î¹Î± Î³ÏÎ®Î³Î¿ÏÎµÏ‚ ÎºÎ±Î¹ Î±Ï€Î»Î­Ï‚ ÎµÏÏ‰Ï„Î®ÏƒÎµÎ¹Ï‚! Î— Î³Î½ÏÏƒÎ· Î¾ÎµÎºÎ¹Î½Î¬ Î±Ï€ÏŒ Ï„Î± Î²Î±ÏƒÎ¹ÎºÎ¬! ğŸ˜Š`
                },
                ...conversationHistory.slice(-6), // Last 3 exchanges for context
                {
                    role: "user", 
                    content: userMessage
                }
            ];

            const response = await fetch('https://api.groq.com/openai/v1/chat/completions', {
                method: 'POST',
                headers: {
                    'Authorization': `Bearer ${apiKey}`,
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    model: "llama-3.1-8b-instant",
                    messages: messages,
                    max_tokens: 600,
                    temperature: 0.7,
                    top_p: 0.9
                })
            });
            
            if (!response.ok) {
                const errorData = await response.json();
                throw new Error(errorData.error?.message || 'Î£Ï†Î¬Î»Î¼Î± ÏƒÏÎ½Î´ÎµÏƒÎ·Ï‚ Î¼Îµ Ï„Î¿ Groq API');
            }
            
            const data = await response.json();
            return data.choices[0].message.content;
        }
        
        function formatAIResponse(text) {
            return text
                .replace(/\n/g, '<br>')
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                .replace(/\*(.*?)\*/g, '<em>$1</em>');
        }
        
        function showError(message) {
            const chat = document.getElementById('chat');
            const errorDiv = document.createElement('div');
            errorDiv.className = 'error-message';
            errorDiv.textContent = message;
            chat.appendChild(errorDiv);
            chat.scrollTop = chat.scrollHeight;
        }
        
        function showTemporaryMessage(message, type) {
            const chat = document.getElementById('chat');
            const messageDiv = document.createElement('div');
            messageDiv.className = type === 'success' ? 'success-message' : 'error-message';
            messageDiv.textContent = message;
            chat.appendChild(messageDiv);
            chat.scrollTop = chat.scrollHeight;
            
            setTimeout(() => {
                messageDiv.remove();
            }, 3000);
        }
        
        function saveConversation(question, answer) {
            // Use sessionStorage only - cleared when browser closes
            let conversations = JSON.parse(sessionStorage.getItem('educate4all_conversations') || '[]');
            conversations.push({
                timestamp: new Date().toISOString(),
                question: question,
                answer: answer,
                aiType: 'simple'
            });
            
            // Keep only last 25 conversations in session
            if (conversations.length > 25) {
                conversations = conversations.slice(-25);
            }
            
            sessionStorage.setItem('educate4all_conversations', JSON.stringify(conversations));
        }
        
        // ENHANCED CLEANUP SYSTEM
        function setupCleanupSystem() {
            // Clear old conversations on load
            clearOldConversations();
            
            // Clear when leaving page
            window.addEventListener('beforeunload', clearOldConversations);
            
            // Clear every 30 minutes
            setInterval(clearOldConversations, 30 * 60 * 1000);
        }
        
        function clearOldConversations() {
            const conversations = JSON.parse(sessionStorage.getItem('educate4all_conversations') || '[]');
            const now = new Date().getTime();
            const twoHoursAgo = now - (2 * 60 * 60 * 1000); // 2 hours
            
            const filteredConversations = conversations.filter(conv => {
                const convTime = new Date(conv.timestamp).getTime();
                return convTime > twoHoursAgo;
            });
            
            sessionStorage.setItem('educate4all_conversations', JSON.stringify(filteredConversations));
        }
    </script>
</body>
</html>
